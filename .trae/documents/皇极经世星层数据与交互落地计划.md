## 总体目标
- 在现有 d3-celestial 背景星空上叠加“皇极经世星层”，随时间/地点真实重投影。
- 完成数据规范、加载与展示、交互（悬停/点击详情）、过滤开关与基础播放联动。

## 数据工作
### 星表范围
- 紫微垣、太微垣、天市垣基准星；二十八宿各宿主星；必要的定位星（帝座等）。

### 字段与结构
- 采用 GeoJSON `FeatureCollection`，每星 `Feature`：
  - `properties`: `id(hj_id)`, `name_cn`, `name_hj`, `hip`, `bayer/iau`, `mag`, `hj.gua`, `hj.fenye`, `hj.yuan/hui/yun/shi`（如有）, `note`, `tags`, `source_refs`。
  - `geometry.coordinates`: `[RA_deg, Dec_deg]`（J2000）。
- 可选扩展：`epoch`, `pm_ra`, `pm_dec`（学术档用）。

### 来源与搜索清单（需采编）
- 权威坐标与编号：SIMBAD / HIP / Tycho / IAU Catalog；Stellarium 数据核对。
- 中文名/星官映射：中科院天文台资料、IAU 中文译名对照；二十八宿主星权威对照表。
- 皇极经世映射：文献/既有 Excel；校对 `卦/分野/元会运世` 的归属与注解。

### 数据校验与一致性
- RA/Dec 统一度数：`RA_deg=(h+m/60+s/3600)*15`；Dec 取正负度。
- 去重与别名统一（同星多名情况）；统一 `hip` 类型为整数。
- 简易校验脚本：检查字段齐备、范围合法、坐标与 `stars.6.json` 交叉抽样匹配。

## 前端接入
### 叠加绘制
- 在前端加载 `cultures/huangji-stars.json`，使用 `Celestial.add` 以 `type:'point'` 添加：
  - 样式：金色系；尺寸随 `mag` 缩放；标签取 `name_hj || name_cn`。
- 仅在 `culture==='hj'` 时加载该层；其他文化不加载。
- 关键挂点：首次渲染后延迟段（与 `drawCn`/`drawStars` 并列），保持 `skyview({date,location,timezone})` 更新。

### 交互
- 悬停/点击：为 `.hj-star` 元素绑定 tooltip/点击事件，从 `properties` 展示 `name_hj/name_cn` 与皇极解释（卦象、分野）。
- 只看皇极星：新增开关，隐藏白色恒星与中国星官标注，保留皇极层，便于专注。
- 时间播放：按钮驱动 `skyview` 每秒推进（小时/天步进可调），观察皇极星在天球上的运行。

### UI 扩展（可选）
- 右侧详情卡片：点击皇极星，显示更多映射与文献引用；支持锚点跳转。
- 搜索框：按中文名/皇极名/HIP 查找并高亮。

## 后端支持
- 数据根：沿用 `/api/celestial/data/` 的 `cultures/` 前缀，已有路由允许；也兼容前端 `/data/` 静态。
- 缓存：加入新文件至 `backend/data/celestial/cultures/`，可配合预热接口；保持哈希校验与白名单安全。

## 验收与测试
- 加载测试：`cultures/huangji-stars.json` 读取成功，未报 404/JSON 错误。
- 显示测试：皇极星在 `culture==='hj'` 场景可见，IAU/中国场景不加载。
- 交互测试：悬停/点击提示正常；只看皇极星开关切换生效；播放按钮驱动 `skyview` 重投影无卡顿。
- 位置随时间验证：不同日期/地点下皇极星屏幕位置变化符合预期（与 Stellarium 抽样对照）。

## 搜索任务列表（具体要查什么）
- “SIMBAD Polaris HIP number RA Dec J2000” 等关键词，拉取北极一等关键星的权威坐标与编号。
- “二十八宿 主星 列表 J2000 坐标” 或中文资料的英文对照，确保坐标与宿归属一致。
- “紫微垣 基准星 名称 HIP Bayer”/“太微垣 基准星”/“天市垣 基准星” 对照。
- “IAU Bayer designation Chinese name mapping” 做中文名与 Bayer/IAU 标识的映射校对。
- 皇极经世具体映射：检索“皇极经世 分野 卦象 星宿 对应”，核对 `gua/fenye/元会运世` 的定义来源。

## 精度策略（后续阶段）
- 学术档：引入 `astronomia`（Meeus）或等效库；对每星按 `epoch/pm_ra/pm_dec` 做岁差与自行修正，生成目标日期的 RA/Dec。
- 性能：皇极星数量有限，可按需计算，动态传入 overlay。

## 风险与边界
- 名称歧义与别名冲突：以 HIP/IAU 编号为主键，中文名作别名。
- 文献差异：注解字段保留来源引用；前端展示时标注“依据某某文献”。
- CDN 或后端数据不可用：维持多级数据根探测与强制回退策略。

## 落地步骤（交付物）
1. 整理并补全皇极星表（GeoJSON），字段齐备、坐标统一，含来源引用。
2. 前端叠加绘制层与样式、标签；条件加载（`culture==='hj'`）。
3. 悬停与点击交互；只看皇极星开关；时间播放驱动重投影。
4. 验收测试与对照（Stellarium/SIMBAD 抽样），修正数据偏差。
5. 文档：数据规范与来源说明，后续精度扩展策略说明。

如无异议，我将按此计划执行，先完成数据校验与前端叠加层的完善，并补齐交互与过滤。